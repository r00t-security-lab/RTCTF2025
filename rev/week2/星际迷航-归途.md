### æ˜Ÿé™…è¿·èˆª-å½’é€”

#### é¢˜ç›®æè¿°

ä»ç¦»å®¶åä¸‡å…‰å¹´å¤„çš„ç¥ç§˜æ˜Ÿçƒå¤„ç»“æŸæ¢é™©ï¼Œr00tçš„é˜Ÿé•¿ç»ˆäºå³å°†è£å½’æ•…ä¹¡ã€‚åªæ˜¯ï¼Œé€šå¾€å®¶ä¹¡çš„æ—…é€”å……æ–¥ç€å„ç§æ˜Ÿçƒå’Œæ˜Ÿé™…åƒåœ¾ï¼Œç¨ä¸ç•™ç¥å°±ä¼šè¢«å¨èƒæŸ¥ç»•ï¼Œç›´æ¥æ­»äº¡ã€‚ å¹¸å¥½ï¼Œonehangé˜Ÿé•¿è®°å¾—ä¸€æ¡md5å¯†ä»¤ï¼Œè®°è½½ç€æœ€çŸ­è·¯çº¿ã€‚å·§å¦™åœ°çˆ†ç ´å‡ºäº†è·¯çº¿ï¼ˆä½ çŒœçœŸçš„è¿˜æ˜¯å‡çš„ğŸ¶ï¼‰ä¹‹åï¼Œé˜Ÿé•¿å®‰å…¨åœ°è¿…é€ŸæˆåŠŸè¿”ä¹¡ã€‚ä½ å¯ä»¥å¤åˆ»é˜Ÿé•¿çš„æˆåŠŸå˜›ï¼Ÿ

#### è§£é¢˜æ€è·¯

ä½¿ç”¨idaæ‰“å¼€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­—ç¬¦ä¸²ä¸­æœ‰ä¸€å †`#.`å†…å®¹ï¼Œæ€€ç–‘å…¶æ˜¯è¿·å®«åœ°å›¾ï¼Œä¸è¿‡å…ˆä¸ç®¡ä»–ä»¬ï¼Œè¿›å…¥åˆ°ä¸»è¦å‡½æ•°ã€‚

<img src="æ˜Ÿé™…è¿·èˆª-å½’é€”/img/image-20251208204934263.png" alt="image-20251208204934263" style="zoom:33%;" />

å°†å¯¹åº”87ä¹‹ç±»çš„æ•°å­—è½¬æˆå­—ç¬¦ä¸²ï¼Œå¾—åˆ°ä»¥ä¸‹å‡½æ•°

```c
int __fastcall sub_14000246C(_DWORD *a1)
{
  FILE *Stream; // rax
  int v3; // eax
  char buf[1008]; // [rsp+20h] [rbp-60h] BYREF
  char Buffer[1007]; // [rsp+410h] [rbp+390h] BYREF
  char n87; // [rsp+7FFh] [rbp+77Fh]
  unsigned int v7; // [rsp+800h] [rbp+780h]
  unsigned int v8; // [rsp+804h] [rbp+784h]
  unsigned int v9; // [rsp+808h] [rbp+788h]
  int i; // [rsp+80Ch] [rbp+78Ch]
  int n998; // [rsp+810h] [rbp+790h]
  unsigned int v12; // [rsp+814h] [rbp+794h]
  unsigned int v13; // [rsp+818h] [rbp+798h]
  unsigned int v14; // [rsp+81Ch] [rbp+79Ch]

  v14 = a1[5];
  v13 = a1[6];
  v12 = a1[7];
  puts(::Buffer);
  sub_140003EF0("Remember to use CAPITAL LETTERS!!!");
  sub_1400022E7(a1, v14, v13, v12);
  sub_140003EF0("Enter your moves: ");
  Stream = __acrt_iob_func(0);
  if ( !fgets(Buffer, 1000, Stream) )
    return puts("Failed to read input.");
  memset(buf, 0, 0x3E8u);
  n998 = 0;
  for ( i = 0; Buffer[i] && n998 <= 998; ++i )
  {
    n87 = Buffer[i];
    v9 = v14;
    v8 = v13;
    v7 = v12;
    if ( n87 == 'W' )
    {
      --v8;
    }
    else
    {
      if ( n87 > 'W' )
        continue;
      if ( n87 == 'U' )
      {
        ++v9;
      }
      else
      {
        if ( n87 > 'U' )
          continue;
        if ( n87 == 'S' )
        {
          ++v8;
        }
        else
        {
          if ( n87 > 'S' )
            continue;
          if ( n87 == 'N' )
          {
            --v9;
          }
          else
          {
            if ( n87 > 'N' )
              continue;
            if ( n87 == 'A' )
            {
              --v7;
            }
            else
            {
              if ( n87 != 'D' )
                continue;
              ++v7;
            }
          }
        }
      }
    }
    v3 = n998++;
    buf[v3] = n87;
    buf[n998] = 0;
    if ( !(unsigned int)sub_1400023D8(a1, v9, v8, v7) )
    {
      puts("\nYou hit a rock or went out of bounds! Game over.");
      puts("Invalid Movement.");
      return puts("Better luck next time!");
    }
    v14 = v9;
    v13 = v8;
    v12 = v7;
    if ( v9 == a1[8] && v13 == a1[9] && v12 == a1[10] )
    {
      puts("\nCongratulations! You copied hang's success and returned home!!!");
      return sub_140003EF0("Flag is r00t2025{md5(%s)}\n", buf);
    }
  }
  puts("\nYou didn't reach the end. Game over.");
  sub_140003EF0("Your path: %s\n", buf);
  return puts("Better luck next time!");
}
```

æ³¨æ„åˆ°é™¤äº†WASDè¿˜æœ‰UNï¼Œä½œä¸ºè¿·å®«å…±å…­ä¸ªæ–¹å‘ï¼Œæ ¹æ®å¤ªç©ºçš„é¢˜ç›®æè¿°å¯ä»¥åŸºæœ¬æ–­å®šæ˜¯ä¸‰ç»´è¿·å®«äº†ã€‚

å…¶ä¸­v9å’ŒUNç›¸å…³ï¼Œv8å’ŒWSç›¸å…³ï¼Œv7å’ŒADç›¸å…³ã€‚

å†å‘ç°ä»¥ä¸‹å‡½æ•°ä¸ºåˆ¤æ–­æ˜¯å¦æˆåŠŸçš„å‡½æ•°ï¼š<img src="æ˜Ÿé™…è¿·èˆª-å½’é€”/img/image-20251208205548468.png" alt="image-20251208205548468" style="zoom:33%;" />

åˆ¤æ–­æ–¹å¼ä¸ºï¼š<img src="æ˜Ÿé™…è¿·èˆª-å½’é€”/img/image-20251208205631383.png" alt="image-20251208205631383" style="zoom:33%;" />

å³`#`ä¸ºå¢™ï¼Œå¦åˆ™ä¸ºé™†åœ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è§‚å¯Ÿåœ°å›¾è¿·å®«æ˜¯ä»€ä¹ˆã€‚

ç»è¿‡åˆ¤æ–­æ‰€åŠ æ•°å­—ï¼Œå¾—åˆ°äº†ä»¥ä¸‹çš„è¿·å®«åœ°å›¾ï¼š

```python
list0 = [
    "..#.......",
    ".#########",
    ".#.#######",
    "...##.....",
    "##########",
    "##########",
    "...###...#",
    ".#.##..#.#",
    ".#...#.###",
    "##.###....",
]
list1 = [
    "#.#.#..##.",
    "#.######..",
    "#.....####",
    "#..######.",
    ".##..###.#",
    "########.#",
    ".#.#####.#",
    ".#######.#",
    ".####..#..",
    "..#.######",
]
list2 = [
    "###.#.#.##",
    ".#######.#",
    "#..##.##.#",
    "#######.#.",
    "######..##",
    "###.##..##",
    "#.#...#.##",
    "#.#.#...#.",
    "##...##.#.",
    "##.#...###",
]
list3 = [
    "###.#...##",
    ".##.#.##.#",
    ".##.#.####",
    "....###..#",
    "##.####.#.",
    "##...###..",
    "#..#####.#",
    "########..",
    "##########",
    "#######...",
]
list4 = [
    "#######.##",
    ".######.##",
    "###.###.##",
    "##.####.##",
    "##.####.#.",
    "##.#..#.##",
    "#.###.#.##",
    "#..#.##.##",
    "#..#...###",
    "#.###....#",
]
list5 = [
    "##########",
    ".#######..",
    "###.###.#.",
    ".########.",
    ".#.###....",
    ".#.###.##.",
    "..####.##.",
    ".######..#",
    "...#.#..##",
    "##...###..",
]
```

ç°åœ¨å°±å·®èµ·ç‚¹å’Œç»ˆç‚¹äº†ã€‚èµ·ç‚¹åœ¨è¿è¡Œæ–‡ä»¶çš„æ—¶å€™å…¶å®å°±å·²ç»çŸ¥é“äº†ï¼Œæ˜¯ï¼ˆ0ï¼Œ0ï¼Œ0ï¼‰ç‚¹ï¼Œè€Œç»ˆç‚¹åˆ¤æ–­æ–¹å¼å¦‚ä¸‹ï¼š<img src="wp/img/image-20251208210207030.png" alt="image-20251208210207030" style="zoom:33%;" />ï¼Œa1æ˜¯ä»å¤–é¢ä¼ è¿›æ¥çš„ï¼Œå®šä½åˆ°a1ï¼š<img src="æ˜Ÿé™…è¿·èˆª-å½’é€”/img/image-20251208210249494.png" alt="image-20251208210249494" style="zoom:33%;" />å‘ç°æ˜¯`v1`ä¼ è¿›æ¥çš„ï¼Œè€Œå…¶åˆæ˜¯`sub_140001707()`è¿”å›çš„ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆè¿·å®«åœ°å›¾çš„å‡½æ•°ã€‚äºæ˜¯è§‚çœ‹ï¼Œå‘ç°å…¶åœ¨æœ€åå®šä¹‰äº†å‡ ä¸ªæ•°ï¼š<img src="wp/img/image-20251208210803864.png" alt="image-20251208210803864" style="zoom: 50%;" />ï¼Œåˆ¤æ–­è¿™å°±æ˜¯å®šä¹‰èµ·ç‚¹å’Œç»ˆç‚¹çš„åœ°æ–¹ï¼Œäºæ˜¯ç»ˆç‚¹ä¾¿æ˜¯ï¼ˆ0ï¼Œ9ï¼Œ9ï¼‰ã€‚

> ä¸Šé¢è¿™ä¸ªå†…å®¹æˆ‘åœ¨å†™ä»£ç æ—¶ä½¿ç”¨çš„æ˜¯ç»“æ„ä½“ï¼Œå¦‚æœå¤§æ¦‚çŸ¥é“äº†ç»“æ„ä½“çš„æƒ…å†µï¼Œå°†å…¶æ¢å¤å¯ä»¥æå¤§ç¨‹åº¦çš„ä½¿ä»£ç æ›´åŠ ç¾è§‚ã€‚è¿™é‡Œæˆ‘ç»™å‡ºæˆ‘ä½¿ç”¨çš„ç»“æ„ä½“ï¼Œæ–¹ä¾¿å¤ç°ï¼š
>
> ```c
> typedef struct
> {
>  char ***grid;    // ä¸‰ç»´è¿·å®«ç½‘æ ¼
>  int levels;      // å±‚æ•°
>  int rows;        // æ¯å±‚è¡Œæ•°
>  int cols;        // æ¯å±‚åˆ—æ•°
>  int start_level; // èµ·ç‚¹å±‚
>  int start_row;   // èµ·ç‚¹è¡Œ
>  int start_col;   // èµ·ç‚¹åˆ—
>  int end_level;   // ç»ˆç‚¹å±‚
>  int end_row;     // ç»ˆç‚¹è¡Œ
>  int end_col;     // ç»ˆç‚¹åˆ—
> } Maze3D;
> ```

åœ¨æœ‰äº†ä¸€åˆ‡ä¿¡æ¯åï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è„šæœ¬è§£å¼€è·¯å¾„äº†ï¼š

```python
# æˆ‘å°†èµ·ç‚¹å’Œç»ˆç‚¹æ”¹æˆäº†Så’ŒEï¼Œæ›´åŠ æ–¹ä¾¿ç¨‹åºé€»è¾‘è¿›è¡Œç¼–å†™å’Œåˆ¤æ–­
list0 = [
    "S.#.......",
    ".#########",
    ".#.#######",
    "...##.....",
    "##########",
    "##########",
    "...###...#",
    ".#.##..#.#",
    ".#...#.###",
    "##.###...E",
]
list1 = [
    "#.#.#..##.",
    "#.######..",
    "#.....####",
    "#..######.",
    ".##..###.#",
    "########.#",
    ".#.#####.#",
    ".#######.#",
    ".####..#..",
    "..#.######",
]
list2 = [
    "###.#.#.##",
    ".#######.#",
    "#..##.##.#",
    "#######.#.",
    "######..##",
    "###.##..##",
    "#.#...#.##",
    "#.#.#...#.",
    "##...##.#.",
    "##.#...###",
]
list3 = [
    "###.#...##",
    ".##.#.##.#",
    ".##.#.####",
    "....###..#",
    "##.####.#.",
    "##...###..",
    "#..#####.#",
    "########..",
    "##########",
    "#######...",
]
list4 = [
    "#######.##",
    ".######.##",
    "###.###.##",
    "##.####.##",
    "##.####.#.",
    "##.#..#.##",
    "#.###.#.##",
    "#..#.##.##",
    "#..#...###",
    "#.###....#",
]
list5 = [
    "##########",
    ".#######..",
    "###.###.#.",
    ".########.",
    ".#.###....",
    ".#.###.##.",
    "..####.##.",
    ".######..#",
    "...#.#..##",
    "##...###..",
]


mazes = [list0, list1, list2, list3, list4, list5]
start:tuple[int, int, int] = (0,0,0)
end:tuple[int, int, int] = (0,0,0)
L = len(mazes)
R = len(mazes[0])
C = len(mazes[0][0])

# æ‰¾èµ·ç‚¹å’Œç»ˆç‚¹

for l in range(L):
    for r in range(R):
        for c in range(C):
            if mazes[l][r][c] == 'S':
                start = (l, r, c)
            elif mazes[l][r][c] == 'E':
                end = (l, r, c)

# BFS æœç´¢

queue = deque()
queue.append((start, [start]))
visited = set()
visited.add(start)

directions = [
(0,-1,0,'W'),  # ä¸Š
(0,1,0,'S'),   # ä¸‹
(0,0,-1,'A'),  # å·¦
(0,0,1,'D'),   # å³
(1,0,0,'U'),   # ä¸Šå±‚
(-1,0,0,'N'),  # ä¸‹å±‚
]

found = False
while queue:
    (l,r,c), path = queue.popleft()

    if (l,r,c) == end:
        print("æ‰¾åˆ°æœ€çŸ­è·¯å¾„ï¼Œé•¿åº¦:", len(path)-1)
        # ç”Ÿæˆç§»åŠ¨åºåˆ—
        moves = []
        for i in range(1, len(path)):
            cl, cr, cc = path[i-1]
            nl, nr, nc = path[i]
            for dl, dr, dc, move in directions:
                if cl+dl == nl and cr+dr == nr and cc+dc == nc:
                    moves.append(move)
                    break
        print("ASDUNåºåˆ—:", ''.join(moves))
        found = True
        break

    for dl, dr, dc, _ in directions:
        nl, nr, nc = l+dl, r+dr, c+dc
        if 0 <= nl < L and 0 <= nr < R and 0 <= nc < C:
            if mazes[nl][nr][nc] != '#' and (nl,nr,nc) not in visited:
                visited.add((nl,nr,nc))
                queue.append(((nl,nr,nc), path+[(nl,nr,nc)]))

if not found:
    print("æ²¡æœ‰æ‰¾åˆ°è·¯å¾„ã€‚")

```

äºæ˜¯å¾—åˆ°è·¯å¾„`DUSSDDDDUUWWDDUSSSSUDDNNSASSDNSNAWWNAASSSDDD`ï¼Œè¿›è¡ŒMD5å¾—åˆ°`f0d0c0909b0af5f204a03f78759046af`ï¼Œæ‰€ä»¥flagå°±æ˜¯`r00t2025{f0d0c0909b0af5f204a03f78759046af}`

è¿™ä¸ªå¤§å°å†™é—®é¢˜æˆ‘å†™çš„å·²ç»ä¸èƒ½å†æ¸…æ¥šäº†æŠŠï¼Œå†é”™å°±ä¸æ˜¯æˆ‘çš„é—®é¢˜äº†å™¢ã€‚

#### å‡ºé¢˜æ€è·¯

ä¸€ä¸ªæ–°ç”Ÿèµ›çš„REVæ²¡æœ‰ä¸€é“è¿·å®«é¢˜æ˜¯ä¸å®Œæ•´ï¼Œè‡³å°‘æˆ‘æ˜¯è¿™ä¹ˆè§‰å¾—çš„ï¼Œä¸è¿‡å¯ä»¥åœ¨å…¶ä¸Šè¿›è¡Œåˆ›æ–°ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å»å¹´çš„æ¯”èµ›ä½¿ç”¨çš„è¿·å®«å­˜å‚¨æ–¹å¼æ˜¯äºŒç»´ç©ºé—´åœ¨ä¸€ç»´æ•°ç»„ä¸­çš„å±•å¼€ï¼Œæƒ³å½“åˆæˆ‘è¿˜æ˜¯çœŸæŒ‰ç…§ä¸€ç»´çš„å½¢å¼åšå‡ºæ¥çš„ï¼ˆ<del>æˆ‘è¿˜æ˜¯æœ‰ç‚¹æƒ³è±¡åŠ›äº†</del>ï¼‰è€Œè¿™æ¬¡æˆ‘å°±é‡‡ç”¨äº†ä¸‰ç»´ç©ºé—´åœ¨äºŒä½æ•°ç»„ä¸­çš„å±•å¼€ï¼Œè¿™å¯æ˜¯æˆ‘çº¯çº¯å¤´è„‘é£æš´ç”»å‡ºæ¥çš„åœ°å›¾ï¼ˆæœ¬æ¥æƒ³å‡ºå››ç»´çš„ï¼Œå¥ˆä½•åœ¨æœ‰é™çš„æ—¶é—´å†…æƒ³ä¸å‡ºå¤§å°é€‚åˆçš„åœ°å›¾ï¼‰ã€‚

å¹¶ä¸”æˆ‘é€šè¿‡ä¸æç¤ºä¸Šä¸‹ä¸¤ä¸ªæ–¹å‘å­—ç¬¦çš„æ–¹å¼ï¼Œé˜»æ­¢äº†å•¥éƒ½ä¸ç®¡ï¼Œå…‰æƒ³ç€çº¯æš´åŠ›ç ´è§£çš„åŒå­¦å¦„å›¾ä½¿ç”¨wasdè·‘ä¸€æ™šä¸Šç›´æ¥æ¢­å‡ºè·¯å¾„ã€‚